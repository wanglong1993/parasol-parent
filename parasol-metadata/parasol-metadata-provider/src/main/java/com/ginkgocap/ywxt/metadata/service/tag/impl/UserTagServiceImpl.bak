package com.ginkgocap.ywxt.metadata.service.tag.impl;

import java.util.List;
import java.util.Map;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.ginkgocap.ywxt.metadata.dao.userTag.UserTagDao;
import com.ginkgocap.ywxt.metadata.model.UserTag;
import com.ginkgocap.ywxt.metadata.service.userTag.UserTagService;
@Service("userTagService")
public class UserTagServiceImpl implements UserTagService {
    @Autowired
    private UserTagDao userTagDao;
    
    private Logger logger = LoggerFactory.getLogger(getClass());
    @Override
    public UserTag selectById(long id) {
        return userTagDao.selectByPrimarKey(id);
    }

	@Override
	public UserTag insert(UserTag userTag) {
		// TODO Auto-generated method stub
		List<UserTag>  list = userTagDao.selectByTagNameAndUserId(userTag.getUserId(), userTag.getTagName());
		//如果用户已经存在标签 ，不保存
		if(list.size() > 0) return list.get(0);
		return userTagDao.insert(userTag);
	}



	@Override
	public void update(UserTag UserTag) {
		// TODO Auto-generated method stub
		userTagDao.update(UserTag);
		return ;
		
	}


	@Override
	public void delete(long id) {
		// TODO Auto-generated method stub
		userTagDao.delete(id);
		
	}


	@Override
	public void deleteByTagNameAndUserId(long userId, String tagName) {
		// TODO Auto-generated method stub
		userTagDao.deleteByTagNameAndUserId(userId, tagName);
		
	}

	@Override
	public List<UserTag> selectByNameAndUserId(long userId, String tagName) {
		// TODO Auto-generated method stub
		return userTagDao.selectByTagNameAndUserId(userId, tagName);
	}
   /**
    * 根据用户id查询分页
    */
	@Override
	public List<UserTag> selectPageByUserId(long userId, long startRow,
			int pageSize) {
		// TODO Auto-generated method stub
		return 	userTagDao.selectByUserId(userId, startRow, pageSize);
	}

	@Override
	public List<UserTag> selectPageByUserIdAndSys(long userId, long startRow,
			int pageSize) {
		// TODO Auto-generated method stub
		return userTagDao.selectByUserIdAndSys(userId, startRow, pageSize);
	}

	@Override
	public long countByUserId(long userId) {
		// TODO Auto-generated method stub
		long count = userTagDao.countByUserId(userId);
		return count;
	}

	@Override
	public long countByUserIdAndSys(long userId) {
		// TODO Auto-generated method stub
		long count = userTagDao.countByUserIdAndSys(userId);
		return count;
	}

	@Override
	public List<UserTag> selectTagNameInUserIdAndSys(long userId, String tagName) {
		// TODO Auto-generated method stub
		return userTagDao.selectTagNameInUserIdAndSys(userId, tagName);
	}

	@Override
	public List<UserTag> searchPrefixPageByUserIdAndSys(long userId,
			String[] keyword, long startRow, int pageSize) {
		// TODO Auto-generated method stub
		return userTagDao.searchPrefixPageByUserIdAndSys(userId, keyword, startRow, pageSize);
	}

	@Override
	public List<UserTag> searchContainPageByUserIdAndSys(long userId,
			String[] keyword, long startRow, int pageSize) {
		// TODO Auto-generated method stub
		return userTagDao.searchContainPageByUserIdAndSys(userId, keyword, startRow, pageSize);
	}

	@Override
	public boolean insert(List<UserTag> userTagList) {
		// TODO Auto-generated method stub
		for (int i = 0; i < userTagList.size(); i++) {
			this.insert(userTagList.get(i));
		}
		return true;
	}

	@Override
	public long countBySys() {
		// TODO Auto-generated method stub
		return userTagDao.countBySys();
	}

	@Override
	public List<UserTag> selectPageBySys(long startRow, int pageSize) {
		// TODO Auto-generated method stub
		return userTagDao.selectPageBySys(startRow, pageSize);
	}

	


}
